<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
            crossorigin="anonymous"
        >
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
            integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        >
        <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='css/layout.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
        <link rel="stylesheet" href="{{ url_for('static', filename='css/custom.css') }}">
    </head>
    <body>
        <header>
            <div class="container d-flex justify-content-between align-items-center">
                <div class="header-logo">
                    <a href="{{ url_for('index') }}">
                        <img src="../static/assets/images/Logo.png" alt="">
                    </a>
                </div>
                <div class="header-nav">
                    <ul class="nav">
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('index') }}">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('new_campaign') }}">New Campaign</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('my_campaigns') }}">My Campaigns</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('transaction') }}">Transactions</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="{{ url_for('community') }}">Community</a>
                        </li>
                    </ul>
                </div>
                <div class="header-connect-wallet" id="wallet-connect-container">
                    <a class="connect-wallet" href="{{ url_for('connect_wallet') }}">
                        <i class="fa-solid fa-wallet" style="margin-right: 0.5rem;"></i>
                        Connect Wallet
                    </a>
                </div>
            </div>
        </header>
        <section class="banner">
            <div class="container">
                <div class="container-1 d-flex">
                    <div class="banner-left">
                        <div class="wrapper-1">
                            <img class="ada-1" src="../static/assets/images/Ada.png" alt="">
                        </div>
                        <div class="wrapper-2">
                            <img class="ada-2" src="../static/assets/images/Ada.png" alt="">
                        </div>
                        <div class="wrapper-3">
                            <img class="ada-3" src="../static/assets/images/Ada.png" alt="">
                        </div>
                        <div class="wrapper-4">
                            <img class="ada-4" src="../static/assets/images/Ada.png" alt="">
                        </div>
                    </div>
                    <div class="banner-right d-flex flex-column align-items-start">
                        <h1>Support Projects With Cardano</h1>
                        <p>A transparent and secure way to donate using blockchain technology. Every transaction is recorded on the Cardano blockchain, ensuring complete transparency.</p>
                        <a href="{{ url_for('new_campaign') }}">Create campaign</a>
                    </div>
                </div>
            </div>
        </section>
        <section class="active-campaigns">
            <div class="container d-flex justify-content-center">
                <div class="container-1">
                    <p class="active-campaigns-text">Active campaigns</p>
                    <div class="active-campaigns-main" id="campaigns-container">
                        <!-- Campaign cards will be loaded here -->
                        <div class="no-campaign d-flex flex-column align-items-center" id="no-campaigns-message">
                            <p>No campaigns available yet</p>
                            <a href="{{ url_for('new_campaign') }}">Create the first campaign</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section class="our-approach">
            <div class="container">
                <div class="our-approach-statistic">

                </div>
                <div class="our-approach-main">
                    <div>

                    </div>
                </div>
            </div>
        </section>
        <footer class="py-4">
            <div class="container">
                <div class="row">
                    <div class="col-md-6">
                        <h5>Cardano Donation Platform</h5>
                        <p style="font-family: Oswald-Light, sans-serif;">A transparent way to donate using blockchain technology</p>
                    </div>
                    <div class="col-md-3">
                        <h5>Links</h5>
                        <ul class="list-unstyled">
                            <li>
                                <a href="{{ url_for('index') }}" class="text-decoration-none text-secondary">Home</a>
                            </li>
                            <li>
                                <a href="{{ url_for('new_campaign') }}" class="text-decoration-none text-secondary">New Campaign</a>
                            </li>
                            <li>
                                <a href="{{ url_for('my_campaigns') }}" class="text-decoration-none text-secondary">My campaigns</a>
                            </li>
                        </ul>
                    </div>
                    <div class="col-md-3">
                        <h5>Connect</h5>
                        <div class="d-flex gap-3 fs-4">
                            <a href="#" class="text-secondary">
                                <i class="fa-brands fa-x-twitter"></i>
                            </a>
                            <a href="#" class="text-secondary">
                                <i class="fa-brands fa-github"></i>
                            </a>
                            <a href="#" class="text-secondary">
                                <i class="fa-brands fa-telegram"></i>
                            </a>
                        </div>
                    </div>
                </div>
                <hr>
                <div class="text-center">
                    <p class="mb-0">&copy; 2023 Cardano Donation Platform. All rights reserved.</p>
                </div>
            </div>
        </footer>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
        <script src="{{ url_for('static', filename='js/wallet-info.js') }}"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                // Check wallet connection
                checkWalletConnection();
                
                // Load campaigns
                loadCampaigns();
            });
            
            function checkWalletConnection() {
                const storedAddress = localStorage.getItem('sender_address');
                if (storedAddress) {
                    // Update wallet connection button
                    document.getElementById('wallet-connect-container').innerHTML = `
                        <a class="connect-wallet connected-wallet" href="{{ url_for('connect_wallet') }}">
                            <i class="fa-solid fa-wallet"></i>
                            Connected: ${storedAddress.substring(0, 10)}...
                        </a>
                    `;
                }
            }

            function loadCampaigns() {
                fetch('/api/campaigns')
                    .then(response => response.json())
                    .then(campaigns => {
                        const campaignsContainer = document.getElementById('campaigns-container');
                        const noCampaignsMessage = document.getElementById('no-campaigns-message');
                        
                        if (campaigns.length > 0) {
                            // Hide the no campaigns message
                            noCampaignsMessage.style.display = 'none';
                            
                            // Create campaign cards
                            const campaignCardsHtml = campaigns.map(campaign => {
                                const progress = (campaign.current_amount / campaign.goal_amount) * 100;
                                const formattedCurrentAmount = (campaign.current_amount / 1000000).toFixed(2);
                                const formattedGoalAmount = (campaign.goal_amount / 1000000).toFixed(2);
                                
                                return `
                                    <div class="campaign-card">
                                        <div class="campaign-image">
                                            <img src="${campaign.image_url || '../static/assets/images/default-campaign.jpg'}" alt="${campaign.title}">
                                        </div>
                                        <div class="campaign-details">
                                            <h3>${campaign.title}</h3>
                                            <p>${campaign.description.substring(0, 100)}${campaign.description.length > 100 ? '...' : ''}</p>
                                            <div class="progress mb-3">
                                                <div class="progress-bar" role="progressbar" style="width: ${progress}%" aria-valuenow="${progress}" aria-valuemin="0" aria-valuemax="100"></div>
                                            </div>
                                            <div class="d-flex justify-content-between">
                                                <span>${formattedCurrentAmount} / ${formattedGoalAmount} ADA</span>
                                                <span>${progress.toFixed(1)}%</span>
                                            </div>
                                            <a href="/campaign/${campaign.id}" class="btn btn-primary mt-3">View Details</a>
                                        </div>
                                    </div>
                                `;
                            }).join('');
                            
                            campaignsContainer.innerHTML = campaignCardsHtml;
                        }
                    })
                    .catch(error => {
                        console.error('Error loading campaigns:', error);
                    });
            }
        </script>
    </body>
</html>